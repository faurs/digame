# Schema documentation

Generated by MySQL Workbench Model Documentation v1.0.0 - Copyright (c) 2015 Hieu Le

## Table: `account`

### Description: 

帳號

### Columns: 

| Column | Data type | Attributes | Default | Description |
| --- | --- | --- | --- | ---  |
| `account_id` | INT | PRIMARY, Not null |   | 帳號ID |
| `operator_id` | INT | Not null, Unique |   | 營運商ID |
| `user_name` | VARCHAR(20) | Not null, Unique |   | 使用者名稱 |
| `balance` | BIGINT | Not null |   | 餘額 |
| `currency_id` | INT | Not null |   | 貨幣ID |
| `status` | INT | Not null |   | 狀態<br />0: 正常<br />1: 凍結<br />2: 停用 |
| `create_time` | BIGINT | Not null |   | 建立時間 |
| `update_time` | BIGINT | Not null |   | 最近一次的修改時間 |
| `is_deleted` | SMALLINT | Not null |   | 邏輯刪除 |


### Indices: 

| Name | Columns | Type | Description |
| --- | --- | --- | --- |
| PRIMARY | `account_id` | PRIMARY |   |
| user_name_UNIQUE | `user_name`, `operator_id` | UNIQUE |   |


## Table: `balance_history`

### Description: 

餘額異動歷史

### Columns: 

| Column | Data type | Attributes | Default | Description |
| --- | --- | --- | --- | ---  |
| `id` | BIGINT | PRIMARY, Auto increments, Not null |   | 流水號 |
| `account_id` | INT | Not null |   | 帳號ID |
| `operator_id` | INT | Not null |   | 營運商ID |
| `amount` | BIGINT | Not null |   | 異動金額的數量 |
| `balance` | BIGINT | Not null |   | 操作完後的餘額 |
| `create_time` | BIGINT | Not null |   | 建立時間 |
| `table_name` | VARCHAR(45) | Not null |   | table名稱<br />紀錄關聯的table名稱 |
| `table_row_id` | BIGINT | Not null |   | table row id<br />紀錄關聯的table對應資料列的ID |


### Indices: 

| Name | Columns | Type | Description |
| --- | --- | --- | --- |
| PRIMARY | `id` | PRIMARY |   |


## Table: `bet_sync`

### Description: 

cq9待同步注單的資料

### Columns: 

| Column | Data type | Attributes | Default | Description |
| --- | --- | --- | --- | ---  |
| `index_id` | VARCHAR(255) | PRIMARY, Not null |   | 訂單索引 |
| `mtcode` | VARCHAR(255) | Not null |   | 交易代碼 |
| `round_code` | VARCHAR(255) | Not null |   | 局號 |
| `round_id` | BIGINT | Not null |   | 局ID |
| `log_bet_status` | INT | Not null |   | 處理前的注單狀態<br />cq9用<br />0: 押注成功<br />1: win api失敗<br />2: win api成功<br />3: end api 成功<br />4: 已補帳 |
| `status` | INT | Not null |   | 注單狀態<br />0: 待sync<br />1: 處理完畢 |
| `create_time` | BIGINT | Not null |   | 建立時間 |
| `done_time` | BIGINT | Not null |   | 完成時間 |


### Indices: 

| Name | Columns | Type | Description |
| --- | --- | --- | --- |
| PRIMARY | `index_id` | PRIMARY |   |


## Table: `currency`

### Description: 

貨幣

### Columns: 

| Column | Data type | Attributes | Default | Description |
| --- | --- | --- | --- | ---  |
| `currency_id` | INT | PRIMARY, Not null |   | 貨幣ID |
| `currency_name` | VARCHAR(20) | Not null |   | 貨幣名稱 |
| `denom` | INT | Not null |   | 匯率<br />錢轉分數的匯率 (單位 1/100): 分數=錢/(Denom/100)=錢x(100/Denom) |


### Indices: 

| Name | Columns | Type | Description |
| --- | --- | --- | --- |
| PRIMARY | `currency_id` | PRIMARY |   |


## Table: `game`

### Description: 

遊戲

### Columns: 

| Column | Data type | Attributes | Default | Description |
| --- | --- | --- | --- | ---  |
| `game_id` | INT | PRIMARY, Not null |   | 遊戲ID |
| `game_name` | VARCHAR(45) | Not null |   | 遊戲名稱 |
| `game_code` | VARCHAR(45) | Not null |   | 遊戲代碼<br />cq9使用 |
| `game_class_id` | INT | Not null |   | 遊戲類別ID<br />主類別 |
| `game_type_id` | INT | Not null |   | 遊戲類型ID<br />類別下的子類型 |
| `line` | INT | Not null |   | 線數<br />slot使用 |
| `bet_multiples` | VARCHAR(200) | Not null |   | 押注乘數<br />slot使用<br />逗點分隔的int字串 |
| `bet_unit` | BIGINT | Not null |   | 押注單位<br />slot使用<br />bet_unit x bet_multiple x line = total bet |
| `room_num` | INT | Not null |   | 預開的房間數 |
| `seat_num` | INT | Not null |   | 預開的座位數 |
| `rtp` | INT | Not null |   | 預設的 rtp |
| `flag` | BIGINT | Not null |   | 旗標<br />每一個bit表示一個開關<br />0: 遊戲是否開放 |


### Indices: 

| Name | Columns | Type | Description |
| --- | --- | --- | --- |
| PRIMARY | `game_id` | PRIMARY |   |


## Table: `game_class`

### Description: 

遊戲類別

### Columns: 

| Column | Data type | Attributes | Default | Description |
| --- | --- | --- | --- | ---  |
| `game_class_id` | INT | PRIMARY, Not null |   | 遊戲類別ID |
| `game_class_name` | VARCHAR(45) | Not null |   | 遊戲類別名稱 |


### Indices: 

| Name | Columns | Type | Description |
| --- | --- | --- | --- |
| PRIMARY | `game_class_id` | PRIMARY |   |


## Table: `game_stat`

### Description: 

遊戲統計

### Columns: 

| Column | Data type | Attributes | Default | Description |
| --- | --- | --- | --- | ---  |
| `game_id` | INT | PRIMARY, Not null |   | 遊戲ID |
| `total_bet` | BIGINT | Not null |   | 總押注 |
| `total_win` | BIGINT | Not null |   | 總贏的金額 |


### Indices: 

| Name | Columns | Type | Description |
| --- | --- | --- | --- |
| PRIMARY | `game_id` | PRIMARY |   |


## Table: `game_type`

### Description: 

遊戲類型<br />類別下的子類型

### Columns: 

| Column | Data type | Attributes | Default | Description |
| --- | --- | --- | --- | ---  |
| `game_class_id` | INT | PRIMARY, Not null |   | 遊戲類別ID |
| `game_type_id` | INT | PRIMARY, Not null |   | 遊戲類型ID |
| `game_type_name` | VARCHAR(45) | Not null |   | 遊戲類型名稱 |


### Indices: 

| Name | Columns | Type | Description |
| --- | --- | --- | --- |
| PRIMARY | `game_class_id`, `game_type_id` | PRIMARY |   |


## Table: `log_api`

### Description: 

api request/response紀錄

### Columns: 

| Column | Data type | Attributes | Default | Description |
| --- | --- | --- | --- | ---  |
| `id` | BIGINT | PRIMARY, Auto increments, Not null |   | 流水號 |
| `api_name` | VARCHAR(45) | Not null |   | api名稱 |
| `operator_code` | VARCHAR(20) | Not null |   | 營運商代碼 |
| `user_name` | VARCHAR(20) | Not null |   | 使用者名稱 |
| `request` | TEXT | Not null |   | request內容 |
| `response` | TEXT | Not null |   | response內容 |
| `code` | INT | Not null |   | 回應碼 |
| `create_time` | BIGINT | Not null |   | 建立時間 |


### Indices: 

| Name | Columns | Type | Description |
| --- | --- | --- | --- |
| PRIMARY | `id` | PRIMARY |   |


## Table: `log_error`

### Description: 

錯誤紀錄

### Columns: 

| Column | Data type | Attributes | Default | Description |
| --- | --- | --- | --- | ---  |
| `id` | BIGINT | PRIMARY, Auto increments, Not null |   | 流水號 |
| `api_name` | VARCHAR(45) | Not null |   | api名稱 |
| `operator_code` | VARCHAR(20) | Not null |   | 營運商ID |
| `user_name` | VARCHAR(20) | Not null |   | 使用者名稱 |
| `request` | TEXT | Not null |   |   |
| `response` | TEXT | Not null |   | response內容 |
| `error_code` | INT | Not null |   | 錯誤碼 |
| `create_time` | BIGINT | Not null |   | 建立時間 |


### Indices: 

| Name | Columns | Type | Description |
| --- | --- | --- | --- |
| PRIMARY | `id` | PRIMARY |   |


## Table: `log_login`

### Description: 

登入資訊

### Columns: 

| Column | Data type | Attributes | Default | Description |
| --- | --- | --- | --- | ---  |
| `id` | BIGINT | PRIMARY, Auto increments, Not null |   | 流水號 |
| `account_id` | INT | Not null |   | 帳號ID |
| `player_code` | VARCHAR(255) | Not null |   | 玩家代碼<br />cq9用 |
| `user_name` | VARCHAR(255) | Not null |   | 使用者名稱 |
| `game_token` | VARCHAR(255) | Not null |   | 遊戲token |
| `game_id` | INT | Not null |   | 遊戲ID |
| `blance` | BIGINT | Not null |   | 餘額 |
| `currency_id` | INT | Not null |   | 貨幣ID |
| `game_hall` | VARCHAR(255) | Not null |   | 遊戲廠商<br />cq9用 |
| `game_platform` | VARCHAR(255) | Not null |   | 遊戲平台<br />cq9用 |
| `game_tech` | VARCHAR(255) | Not null |   | 使用技術<br />cq9用 |
| `game_type` | VARCHAR(255) | Not null |   | 遊戲類型<br />cq9用 |
| `parent_code` | VARCHAR(255) | Not null |   | 代理ID<br />cq9用 |
| `owner_code` | VARCHAR(255) | Not null |   | 上層代理ID<br />cq9用 |
| `login_ip` | VARCHAR(255) | Not null |   | 登入IP |
| `create_time` | BIGINT | Not null |   | 建立時間 |


### Indices: 

| Name | Columns | Type | Description |
| --- | --- | --- | --- |
| PRIMARY | `id` | PRIMARY |   |


## Table: `log_logout`

### Description: 

登出資訊

### Columns: 

| Column | Data type | Attributes | Default | Description |
| --- | --- | --- | --- | ---  |
| `id` | BIGINT | PRIMARY, Auto increments, Not null |   | 流水號 |
| `account_id` | INT | Not null |   | 帳號ID |
| `player_code` | VARCHAR(255) | Not null |   | 玩家代碼<br />cq9用 |
| `game_token` | VARCHAR(255) | Not null |   | 遊戲token |
| `game_id` | INT | Not null |   | 遊戲ID |
| `blance` | BIGINT | Not null |   | 餘額 |
| `create_time` | BIGINT | Not null |   | 建立時間 |


### Indices: 

| Name | Columns | Type | Description |
| --- | --- | --- | --- |
| PRIMARY | `id` | PRIMARY |   |


## Table: `log_order`

### Description: 

轉入轉出紀錄

### Columns: 

| Column | Data type | Attributes | Default | Description |
| --- | --- | --- | --- | ---  |
| `id` | BIGINT | PRIMARY, Auto increments, Not null |   | 單號 |
| `account_id` | INT | Not null |   | 帳號ID |
| `operator_id` | INT | Not null, Unique |   | 營運商ID |
| `order_id` | VARCHAR(50) | Not null, Unique |   | 交易唯一碼 |
| `amount` | BIGINT | Not null |   | 金額<br />正數: 轉入錢包<br />負數: 轉出錢包 |
| `balance` | BIGINT | Not null |   | 操作完後的餘額 |
| `order_status` | TINYINT | Not null |   | 交易狀態<br />0: 成功<br />1: 餘額不足 |
| `create_time` | BIGINT | Not null |   | 建立時間 |


### Indices: 

| Name | Columns | Type | Description |
| --- | --- | --- | --- |
| PRIMARY | `id` | PRIMARY |   |
| order_id_UNIQUE | `order_id`, `operator_id` | UNIQUE |   |


## Table: `log_slot_bet`

### Description: 

slot的注單<br />一局會有一個注單

### Columns: 

| Column | Data type | Attributes | Default | Description |
| --- | --- | --- | --- | ---  |
| `id` | BIGINT | PRIMARY, Auto increments, Not null |   | 流水號 |
| `account_id` | INT | Not null |   | 帳號ID |
| `player_code` | VARCHAR(255) | Not null |   | 玩家代碼<br />cq9用 |
| `game_token` | VARCHAR(255) | Not null |   | 遊戲token |
| `game_id` | INT | Not null |   | 遊戲ID |
| `round_id` | BIGINT | Not null, Unique |   | 局ID |
| `bet` | BIGINT | Not null |   | 押注 |
| `win` | BIGINT | Not null |   | 贏的金額 |
| `balance` | BIGINT | Not null |   | 計算完bet、win後的餘額 |
| `fg_times` | INT | Not null |   | free game次數 |
| `ld_times` | INT | Not null |   | lucky draw次數 |
| `bg_times` | INT | Not null |   | bonus game次數 |
| `bet_time` | BIGINT | Not null |   | 押注時間 |
| `end_time` | BIGINT | Not null |   | 結算時間 |
| `status` | INT | Not null |   | 注單狀態<br />cq9用<br />0: 押注成功<br />1: win api失敗<br />2: win api成功<br />3: end api 成功<br />4: 已補帳 |


### Indices: 

| Name | Columns | Type | Description |
| --- | --- | --- | --- |
| PRIMARY | `id` | PRIMARY |   |
| round_id_UNIQUE | `round_id` | UNIQUE |   |


## Table: `log_slot_bet_detail`

### Description: 

slot的細單<br />每個spin對應一個細單

### Columns: 

| Column | Data type | Attributes | Default | Description |
| --- | --- | --- | --- | ---  |
| `id` | BIGINT | PRIMARY, Auto increments, Not null |   | 流水號 |
| `account_id` | INT | Not null |   | 帳號ID |
| `player_code` | VARCHAR(255) | Not null |   | 玩家代碼<br />cq9用 |
| `game_id` | INT | Not null |   | 遊戲ID |
| `round_id` | BIGINT | Not null |   | 局ID |
| `game_mode` | INT | Not null |   | 遊戲模式<br />0: base game<br />1: bonus game<br />2: lucky draw<br />3: free game |
| `spin_serial` | INT | Not null |   | 此局一輪中bonus game play、lucky draw play、free game spin的流水號 |
| `win` | BIGINT | Not null |   | 贏的金額 |
| `detail` | TEXT | Not null |   |   |
| `spin_time` | BIGINT | Not null |   | spin的時間 |


### Indices: 

| Name | Columns | Type | Description |
| --- | --- | --- | --- |
| PRIMARY | `id` | PRIMARY |   |


## Table: `operator`

### Description: 

營運商

### Columns: 

| Column | Data type | Attributes | Default | Description |
| --- | --- | --- | --- | ---  |
| `operator_id` | INT | PRIMARY, Not null |   | 營運商ID |
| `operator_code` | VARCHAR(20) | Not null |   | 營運商代碼 |
| `team_code` | VARCHAR(45) | Not null |   | 團隊代碼<br />cq9用 |
| `encrypt_key` | VARCHAR(255) | Not null |   | 加密金鑰<br />錢包API用 |
| `note` | VARCHAR(100) | Not null |   | 說明 |
| `is_deleted` | SMALLINT | Not null |   | 邏輯刪除 |


### Indices: 

| Name | Columns | Type | Description |
| --- | --- | --- | --- |
| PRIMARY | `operator_id` | PRIMARY |   |


## Table: `system_value`

### Description: 

系統用的key-value

### Columns: 

| Column | Data type | Attributes | Default | Description |
| --- | --- | --- | --- | ---  |
| `skey` | VARCHAR(45) | PRIMARY, Not null |   | key<br />last_bet_sync_time: 上次注單與cq9同步的時間<br />slot_round_id: slot的round id, 當作除注單round id外的另一個備援資料<br />money_fraction_multiple: 錢小數轉整數時要乘的倍數; 以整數型態保存, 轉為小數需除以此欄位<br />round_code_prefix: 局號 prefix<br />cq9_env: cq9 環境<br />cq9_auth_header_key: cq9 api auth header key<br />cq9_auth_header_value: cq9 api auth header value<br />cq9_site_url: cq9 API base url<br />cq9_max_win: cq9單一spin允許的最大贏取金額 |
| `svalue` | VARCHAR(255) | Not null |   | value |


### Indices: 

| Name | Columns | Type | Description |
| --- | --- | --- | --- |
| PRIMARY | `skey` | PRIMARY |   |


